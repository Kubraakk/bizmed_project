{% extends 'web/base.html' %}
{% load static %}

{% block title %}Tanımlar{% endblock %}

{% block content %}
<div class="page-wrapper">
  <h1 class="page-title">⚙️ Tanımlar</h1>
  <p class="page-desc">Bölümleri ve doktorları yönetin</p>

  <div class="grid">
    <!-- ✅ Bölümler -->
    <div class="card">
      <h2>🏥 Bölümler</h2>
      <form method="post">
        {% csrf_token %}
        <div class="field">
          <input type="text" name="department_name" placeholder="Yeni bölüm adı girin..." required>
        </div>
        <button type="submit" name="add_department" class="btn btn-wide">Ekle</button>
      </form>

      <ul>
        {% for dept in departments %}
          <li class="list-item">
            <span>🏥 {{ dept.name }}</span>
            <form method="post">
              {% csrf_token %}
              <input type="hidden" name="delete_department_id" value="{{ dept.id }}">
              <button type="submit" class="delete-btn">Sil</button>
            </form>
          </li>
        {% empty %}
          <p class="empty-text">Henüz bölüm eklenmemiş.</p>
        {% endfor %}
      </ul>
    </div>

    <!-- ✅ Doktorlar -->
    <div class="card">
      <h2>👨‍⚕️ Doktorlar</h2>
      <form method="post">
        {% csrf_token %}
        <div class="field">
          <input type="text" name="first_name" placeholder="Doktor adı" required>
        </div>
        <div class="field">
          <input type="text" name="last_name" placeholder="Doktor soyadı" required>
        </div>
        <div class="field">
          <select name="department_id" required>
            <option value="">Bölüm seçin</option>
            {% for dept in departments %}
              <option value="{{ dept.id }}">{{ dept.name }}</option>
            {% endfor %}
          </select>
        </div>
        <button type="submit" name="add_doctor" class="btn btn-wide">Ekle</button>
      </form>

      <ul>
        {% for doctor in doctors %}
          <li class="list-item">
            <span>👨‍⚕️ Dr. {{ doctor.first_name }} {{ doctor.last_name }} <small>({{ doctor.department.name }})</small></span>
            <form method="post">
              {% csrf_token %}
              <input type="hidden" name="delete_doctor_id" value="{{ doctor.id }}">
              <button type="submit" class="delete-btn">Sil</button>
            </form>
          </li>
        {% empty %}
          <p class="empty-text">Henüz doktor eklenmemiş.</p>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>
{% endblock %}
